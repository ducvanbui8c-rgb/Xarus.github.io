<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Qu·∫£n l√Ω t√†i ch√≠nh c√° nh√¢n</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
    --primary:#2c7be5;
    --bg:#f4f6f8;
}

*{box-sizing:border-box}

body{
    margin:0;
    font-family:Arial, sans-serif;
    background:var(--bg);
}

header{
    background:var(--primary);
    color:white;
    padding:1rem;
    text-align:center;
}

nav{
    display:flex;
    flex-wrap:wrap;
    background:white;
}

nav button{
    flex:1;
    padding:0.8rem;
    border:none;
    background:none;
    font-weight:bold;
    cursor:pointer;
}

nav button.active{
    background:var(--primary);
    color:white;
}

.container{
    max-width:1100px;
    margin:1rem auto;
    background:white;
    padding:1rem;
    border-radius:8px;
}

h2{color:var(--primary)}

input,select,button{
    width:100%;
    padding:0.6rem;
    margin-top:0.4rem;
}

button{
    background:var(--primary);
    color:white;
    border:none;
    border-radius:5px;
    cursor:pointer;
}

.form-grid{
    display:grid;
    grid-template-columns:repeat(2,1fr);
    gap:10px;
}

.table-wrapper{overflow-x:auto}

table{
    width:100%;
    border-collapse:collapse;
    margin-top:1rem;
}

th,td{
    border:1px solid #ccc;
    padding:0.5rem;
    text-align:center;
}

.income{color:green}
.expense{color:red}
.hidden{display:none}

@media(max-width:768px){
    .form-grid{grid-template-columns:1fr}
}
</style>
</head>

<body>

<header>
    <h1>Website Qu·∫£n L√Ω T√†i Ch√≠nh C√° Nh√¢n</h1>
</header>

<nav>
    <button class="active" onclick="showSection('dashboard')">üè† T·ªïng quan</button>
    <button onclick="showSection('transaction')">üí∏ Thu / Chi</button>
    <button onclick="showSection('category')">üìÇ Danh m·ª•c</button>
    <button onclick="showSection('budget')">üéØ Ng√¢n s√°ch</button>
    <button onclick="showSection('report')">üìä B√°o c√°o</button>
    <button onclick="showSection('setting')">‚öôÔ∏è C√†i ƒë·∫∑t</button>
</nav>

<div class="container">

<!-- DASHBOARD -->
<section id="dashboard">
    <h2>T·ªïng quan t√†i ch√≠nh</h2>
    <p>T·ªïng thu: <span class="income" id="totalIncome">0</span></p>
    <p>T·ªïng chi: <span class="expense" id="totalExpense">0</span></p>
    <p>S·ªë d∆∞: <strong id="balance">0</strong></p>
</section>

<!-- TRANSACTION -->
<section id="transaction" class="hidden">
    <h2>Th√™m kho·∫£n thu / chi</h2>

    <div class="form-grid">
        <input id="desc" placeholder="M√¥ t·∫£">
        <input id="amount" type="number" placeholder="S·ªë ti·ªÅn">

        <select id="type">
            <option value="income">Thu nh·∫≠p</option>
            <option value="expense">Chi ti√™u</option>
        </select>

        <select id="category"></select>
    </div>

    <input id="quickCategory" placeholder="‚ûï Th√™m danh m·ª•c nhanh (vd: Ti·ªÅn nh√†)">
    <button onclick="addQuickCategory()">Th√™m danh m·ª•c</button>

    <button onclick="addTransaction()">‚ûï Th√™m giao d·ªãch</button>

    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>M√¥ t·∫£</th>
                    <th>S·ªë ti·ªÅn</th>
                    <th>Lo·∫°i</th>
                    <th>Nh√≥m</th>
                    <th>Th·ªùi gian</th>
                </tr>
            </thead>
            <tbody id="transactions"></tbody>
        </table>
    </div>
</section>

<!-- CATEGORY -->
<section id="category" class="hidden">
    <h2>Danh m·ª•c</h2>
    <input id="newCategory" placeholder="T√™n danh m·ª•c m·ªõi">
    <button onclick="addCategory()">‚ûï Th√™m danh m·ª•c</button>
    <ul id="categoryList"></ul>
</section>

<!-- BUDGET -->
<section id="budget" class="hidden">
    <h2>Ng√¢n s√°ch theo danh m·ª•c</h2>
    <select id="budgetCategory"></select>
    <input id="budgetAmount" type="number" placeholder="S·ªë ti·ªÅn t·ªëi ƒëa">
    <button onclick="setBudget()">üíæ L∆∞u ng√¢n s√°ch</button>
    <ul id="budgetList"></ul>
</section>

<!-- REPORT -->
<section id="report" class="hidden">
    <h2>B√°o c√°o</h2>
    <button onclick="exportCSV()">üì• Xu·∫•t CSV</button>
</section>

<!-- SETTING -->
<section id="setting" class="hidden">
    <h2>C√†i ƒë·∫∑t</h2>
    <button onclick="clearData()">üóëÔ∏è X√≥a to√†n b·ªô d·ªØ li·ªáu</button>
</section>

</div>

<script>
let data = JSON.parse(localStorage.getItem("data")) || [];
let categories = JSON.parse(localStorage.getItem("categories")) || 
["ƒÇn u·ªëng","H·ªçc t·∫≠p","Gi·∫£i tr√≠","ƒêi l·∫°i","Kh√°c"];
let budgets = JSON.parse(localStorage.getItem("budgets")) || {};

function save(){
    localStorage.setItem("data",JSON.stringify(data));
    localStorage.setItem("categories",JSON.stringify(categories));
    localStorage.setItem("budgets",JSON.stringify(budgets));
}

function showSection(id){
    document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
    document.getElementById(id).classList.remove("hidden");
    document.querySelectorAll("nav button").forEach(b=>b.classList.remove("active"));
    event.target.classList.add("active");
}

function render(){
    let income=0, expense=0;
    transactions.innerHTML="";
    data.forEach(t=>{
        t.type==="income"?income+=t.amount:expense+=t.amount;
        transactions.innerHTML+=`
        <tr>
            <td>${t.desc}</td>
            <td>${t.amount}</td>
            <td class="${t.type}">${t.type}</td>
            <td>${t.category}</td>
            <td>${t.time}</td>
        </tr>`;
    });
    totalIncome.innerText=income;
    totalExpense.innerText=expense;
    balance.innerText=income-expense;
    save();
}

function addTransaction(){
    if(!desc.value || !amount.value) return alert("Nh·∫≠p ƒë·ªß th√¥ng tin");
    data.push({
        desc:desc.value,
        amount:+amount.value,
        type:type.value,
        category:category.value,
        time:new Date().toLocaleString()
    });
    render();
}

function loadCategories(){
    category.innerHTML="";
    budgetCategory.innerHTML="";
    categoryList.innerHTML="";
    categories.forEach(c=>{
        category.innerHTML+=`<option>${c}</option>`;
        budgetCategory.innerHTML+=`<option>${c}</option>`;
        categoryList.innerHTML+=`<li>${c}</li>`;
    });
}

function addQuickCategory(){
    if(!quickCategory.value) return;
    if(categories.includes(quickCategory.value))
        return alert("Danh m·ª•c ƒë√£ t·ªìn t·∫°i");
    categories.push(quickCategory.value);
    quickCategory.value="";
    loadCategories();
    save();
}

function addCategory(){
    if(!newCategory.value) return;
    categories.push(newCategory.value);
    newCategory.value="";
    loadCategories();
    save();
}

function setBudget(){
    budgets[budgetCategory.value]=+budgetAmount.value;
    budgetList.innerHTML="";
    for(let c in budgets){
        budgetList.innerHTML+=`<li>${c}: ${budgets[c]}</li>`;
    }
    save();
}

function exportCSV(){
    let csv="M√¥ t·∫£,S·ªë ti·ªÅn,Lo·∫°i,Nh√≥m,Th·ªùi gian\n";
    data.forEach(t=>csv+=`${t.desc},${t.amount},${t.type},${t.category},${t.time}\n`);
    let a=document.createElement("a");
    a.href=URL.createObjectURL(new Blob([csv]));
    a.download="quan_ly_tai_chinh.csv";
    a.click();
}

function clearData(){
    if(confirm("X√≥a to√†n b·ªô d·ªØ li·ªáu?")){
        localStorage.clear();
        location.reload();
    }
}

loadCategories();
render();
</script>

</body>
</html>
